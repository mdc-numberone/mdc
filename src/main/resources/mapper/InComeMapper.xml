<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.mdc.mapper.mdc.InComeMapper">

    <select id="selectStaticIncomeGroupByLevel" resultType="Map">
        <foreach collection="map" index="key" item="value" separator="UNION">
            select
             #{key} as level,ifnull(sum(if(contract_salary>#{burnValue},#{burnValue},contract_salary)),0) as totalStaticNum
            from
            mdc_income
            where
            sel_date = left(#{selDate},10) and FIND_IN_SET(user_id,#{value.ids}) and type = 1
        </foreach>
    </select>
</mapper>